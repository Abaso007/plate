---
title: Node.js
description: 为 Node.js 安装和配置 Plate
---

本指南演示如何在 Node.js 环境中使用 Plate。这对于后端任务（如数据处理、内容迁移、校验）或任何需要在无浏览器或无完整 React 前端的情况下操作 Plate 编辑器内容的场景都很有用。

<Callout type="warning" title="Node.js 关键限制">
  在 Node.js 环境中使用 Plate 时，**绝不能**从任何 `platejs*` 包的 `/react` 子路径导入。始终使用基础导入（如 `@platejs/basic-nodes`，而不是 `@platejs/basic-nodes/react`）。

  这意味着你不能使用 `platejs/react` 的 `createPlateEditor`。请改用 `platejs` 的 `createSlateEditor`。
</Callout>

<Steps>

### 安装 Plate

安装核心 Plate 包以及你数据处理所需的特定插件包。

```bash
npm add platejs @platejs/basic-nodes
```

-   `platejs`：核心 Plate 引擎和 Slate 编辑器功能。
-   `@platejs/basic-nodes`：基础节点插件，如标题、粗体、斜体、下划线等。

### 创建编辑器实例

在 Node.js 脚本中，使用 `platejs` 的 `createSlateEditor` 初始化编辑器实例。此函数与框架无关，不依赖 React 或浏览器 API。

```typescript title="scripts/process-content.ts"
import { createSlateEditor } from 'platejs';
import {
  BaseBoldPlugin,
  BaseItalicPlugin,
  BaseUnderlinePlugin,
  BaseH1Plugin,
  BaseH2Plugin,
  BaseH3Plugin,
  BaseBlockquotePlugin,
} from '@platejs/basic-nodes';

const initialValue = [
  {
    type: 'h3',
    children: [{ text: '文档标题' }],
  },
  {
    type: 'blockquote',
    children: [{ text: '这是一个引用。' }],
  },
  {
    type: 'p',
    children: [
      { text: '包含一些 ' },
      { text: '粗体', bold: true },
      { text: ' 文本以示强调！' },
    ],
  },
];

const editor = createSlateEditor({
  plugins: [
    BaseBoldPlugin,
    BaseItalicPlugin,
    BaseUnderlinePlugin,
    BaseH1Plugin,
    BaseH2Plugin,
    BaseH3Plugin,
    BaseBlockquotePlugin,
  ],
  value: initialValue,
});

// 现在你可以使用 editor.children、editor.api、editor.tf 等
console.log('编辑器内容:', editor.children);
```

<Callout type="info">
  `createSlateEditor` 创建一个原始的 Slate 编辑器实例，适用于服务端逻辑、数据转换或准备静态渲染内容。它提供与 React 版本相同的 API，但没有浏览器依赖。
</Callout>

### 内容操作

在 Node.js 中使用 Plate 的主要场景是编程式内容操作：

```typescript title="scripts/transform-content.ts"
import { createSlateEditor } from 'platejs';
import {
  BaseBoldPlugin,
  BaseItalicPlugin,
  BaseH1Plugin,
  BaseH2Plugin,
  BaseH3Plugin,
  BaseBlockquotePlugin,
} from '@platejs/basic-nodes';

async function processDocument(value: any[]) {
  const editor = createSlateEditor({
    plugins: [
      BaseBoldPlugin,
      BaseItalicPlugin,
      BaseH1Plugin,
      BaseH2Plugin,
      BaseH3Plugin,
      BaseBlockquotePlugin,
    ],
    value,
  });

  // 提取文本内容
  const textContent = editor.api.string([]);
  console.log('提取的文本:', textContent);

  // 将所有 H1 转为 H2
  editor.tf.setNodes(
    { type: 'h2' },
    { at: [], match: (n) => n.type === 'h1' }
  );

  // 在末尾添加新段落
  editor.tf.insertNodes(
    [{ type: 'p', children: [{ text: '由 Node.js 脚本添加！' }] }],
    { at: [editor.children.length] }
  );

  return {
    textContent,
    transformedValue: editor.children,
  };
}

// 示例用法
const mySlateValue = [
  { type: 'h1', children: [{ text: '原始文档标题' }] },
  { type: 'p', children: [{ text: '一些段落内容。' }] },
  {
    type: 'p',
    children: [
      { text: '包含 ' },
      { text: '粗体', bold: true },
      { text: ' 格式的文本。' },
    ],
  },
];

processDocument(mySlateValue).then(result => {
  console.log('处理完成:', result);
});
```

### 可用 API

-   **[`editor.api`](/docs/api/slate/editor-api)**：访问各种实用函数以查询编辑器状态：
    -   `editor.api.nodes({ at: [], match })`：查找特定节点
    -   `editor.api.string([])`：提取文本内容
    -   [HTML 序列化](/docs/html)
    -   [Markdown 序列化](/docs/markdown)

-   **[`editor.tf`](/docs/api/slate/editor-transforms)**：使用变换函数修改编辑器内容：
    -   `editor.tf.insertNodes(nodes, opts)`：插入新节点
    -   `editor.tf.removeNodes(opts)`：删除节点
    -   `editor.tf.setNodes(props, opts)`：更新现有节点属性
    -   `editor.tf.normalize({ force: true })`：规范化编辑器

</Steps>

### 下一步

在 Node.js 环境中配置好 Plate 后，你可以：

*   **构建内容流水线：** 创建脚本，将其他系统的内容迁移为 Plate 格式
*   **批量操作：** 对现有 Plate 文档进行批量更新或转换
*   **数据提取：** 校验内容结构，或从文档中提取特定数据
*   **后端集成：** 与其他后端服务集成，实现内容处理流水线
*   **静态生成：** 探索 [Markdown 序列化](/docs/markdown)、[HTML 序列化](/docs/html) 和 [`PlateStatic`](/docs/plate-static) 以生成静态内容 