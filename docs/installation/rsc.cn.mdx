---
title: RSC
description: 为 React Server Components 安装和配置 Plate
---

本指南演示如何在 React Server Components (RSC) 中使用 Plate，适用于静态内容生成或服务端数据处理等任务。Plate 的核心设计为服务端安全，可在无浏览器环境下处理编辑器内容。

<Callout type="warning" title="RSC 关键限制">
  在 RSC 中使用 Plate 时，**绝不能**从任何 `platejs*` 包的 `/react` 子路径导入。始终使用基础导入（如 `@platejs/basic-nodes`，而不是 `@platejs/basic-nodes/react`）。

  这意味着你不能使用 `platejs/react` 的 `createPlateEditor`。请改用 `platejs` 的 `createSlateEditor`。
</Callout>

<Steps>

### 安装 Plate

安装核心 Plate 包以及你需要的特定插件包。

```bash
npm add platejs @platejs/basic-nodes
```

### 创建编辑器实例

在 RSC 环境中，使用 `platejs` 的 `createSlateEditor` 初始化编辑器实例。此函数不依赖 React hooks 或客户端专用代码。

以下示例展示了如何用多种插件设置编辑器，类似于 [服务端示例](/docs/examples/server-side)：

```tsx title="app/api/generate-doc/route.ts"
import { createSlateEditor } from 'platejs';
import { BaseTextAlignPlugin } from '@platejs/basic-styles';
import { BaseAutoformatPlugin } from '@platejs/autoformat';
import {
  BaseBoldPlugin,
  BaseCodePlugin,
  BaseItalicPlugin,
  BaseBlockquotePlugin,
  BaseH1Plugin,
  BaseH2Plugin,
  BaseH3Plugin,
} from '@platejs/basic-nodes';
import { MarkdownPlugin, remarkMdx } from '@platejs/markdown';
import remarkGfm from 'remark-gfm';
import remarkMath from 'remark-math';

// 示例初始值
const initialValue = [
  { type: 'h1', children: [{ text: '服务端生成的文档' }] },
  { type: 'p', children: [{ text: '此内容在服务端处理。' }] },
  { type: 'blockquote', children: [{ text: '这是一个引用。' }] },
  { type: 'p', children: [{ text: '这是粗体。', bold: true }] },
];

// 创建编辑器实例
const editor = createSlateEditor({
  plugins: [
    // 块级插件
    BaseH1Plugin,
    BaseH2Plugin,
    BaseH3Plugin,
    BaseBlockquotePlugin,
    BaseTextAlignPlugin,
    // ... 根据需要添加更多 element 插件

    // Mark 插件
    BaseBoldPlugin,
    BaseItalicPlugin,
    BaseCodePlugin,
    // ... 添加更多 mark 插件

    // 功能插件
    BaseAutoformatPlugin,
    MarkdownPlugin.configure({ // 序列化示例
      options: {
        remarkPlugins: [remarkMath, remarkGfm, remarkMdx],
      },
    }),
    // ... 添加其他功能插件
  ],
  value: initialValue, // 设置初始内容
});

// 现在你可以使用 editor.children、editor.api、editor.tf 等
// 例如，获取文本内容：
const textContent = editor.api.string([]);
// console.log('文本内容:', textContent);

// 或序列化为 Markdown：
const markdown = editor.api.markdown.serialize();
// console.log('Markdown 输出:', markdown);

// 编辑器实例可用于各种服务端任务。
// 有关在 RSC 页面中使用此功能进行渲染的完整示例，
// 请参阅 /docs/examples/server-side 页面。
```

<Callout type="info">
  `createSlateEditor` 创建一个原生 Slate 编辑器实例。它适用于服务端逻辑、数据转换或为静态渲染准备内容。可参考完整的 [服务端示例](/docs/examples/server-side) 了解实际用法。
</Callout>

### 内容操作

在 RSC 中使用 Plate 的主要场景是编程式内容操作：

-   **[`editor.api`](/docs/api/slate/editor-api)**：访问各种实用函数以查询编辑器状态。例如：
    -   `editor.api.nodes({ at: [], match })`：查找特定节点。
    -   `editor.api.string([])`：提取文本内容。
    -   [HTML 序列化](/docs/html)
    -   [Markdown 序列化](/docs/markdown)

-   **[`editor.tf`](/docs/api/slate/editor-transforms)**：使用变换函数修改编辑器内容。例如：
    -   `editor.tf.insertNodes(nodes, opts)`：插入新节点。
    -   `editor.tf.removeNodes(opts)`：删除节点。
    -   `editor.tf.setNodes(props, opts)`：更新现有节点属性。
    -   `editor.tf.normalize({ force: true })`：规范化编辑器。

</Steps>

### 下一步

在 RSC 环境中配置好 Plate 后，你可以：

*   构建服务端内容生成和转换流水线。
*   对现有 Plate 文档进行批量更新或转换。
*   校验内容结构，或从文档中提取特定数据。
*   与其他后端服务集成，实现内容处理。
*   如需生成静态内容，可探索 [Markdown 序列化](/docs/markdown)、[HTML 序列化](/docs/html) 和 [`PlateStatic`](/docs/plate-static)。 