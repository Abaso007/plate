---
title: Playwright Testing
description: Learn how to write Playwright tests that integrate with Plate.
---

[Playwright](https://playwright.dev/) enables end-to-end testing in headless browsers. This guide covers integrating Playwright with Plate using `@udecode/plate-playwright`.

## Setup

<Steps>

### Install Dependencies

Follow [Playwright's guide](https://playwright.dev/docs/intro) to install Playwright in your app and ensure that you can write basic end-to-end tests.

```bash
npm install @udecode/plate-playwright playwright
```

### Add PlaywrightPlugin

Add `PlaywrightPlugin` to your editor to enable test utilities:

```tsx
const editor = createPlateEditor({
  plugins: [
    // other plugins...
    PlaywrightPlugin.configure({ enabled: process.env.NODE_ENV !== 'production' }),
  ]
})
```

This exposes various utilities on `window.platePlaywrightAdapter`.

### Get Editor Handle

<Callout>

**What is an editor handle?**

Most Playwright test code runs in a non-browser environment. Interacting with a Plate editor requires running JavaScript inside the browser context using Playwright's `evaluate` and `evaluateHandle` [APIs](https://playwright.dev/docs/evaluating).

A [handle](https://playwright.dev/docs/handles) references a JavaScript object within the browser. The editor handle refers to the `editor` instance of your Plate editor (`JSHandle<PlateEditor>`).

</Callout>

In your Playwright test, get the editor handle before interacting with Plate:

```ts
const editorHandle = await getEditorHandle(page);
```

For multiple editors, specify the editable element:

```ts
const editable = getEditable(page.getByTestId('my-editor-container'));
const editorHandle = await getEditorHandle(page, editable);
```

The locator must match exactly one `[data-slate-editor]` element.

### Start Writing Tests

With the `editorHandle`, you can now write Playwright tests for your editor.

</Steps>

## Examples

### Get a node handle by its path

Use `getNodeByPath` to get a handle referencing the node at a specific path. To make assertions about the value of the node, convert it to JSON using `.jsonValue()`.

```ts
const nodeHandle = await getNodeByPath(page, editorHandle, [0]);

expect(await nodeHandle.jsonValue()).toBe({
  type: 'p',
  children: [{ text: 'My paragraph' }],
});
```

### Get the type of a node

```ts
const firstNodeType = await getTypeAtPath(page, editorHandle, [0]);
expect(firstNodeType).toBe('h1');
```

### Get the DOM node for a node

Often in Playwright, you'll want to reference a specific DOM element in order to make assertions about its state or perform operations involving it.

`getDOMNodeByPath` returns an [ElementHandle](https://playwright.dev/docs/api/class-elementhandle) for the DOM node corresponding to the Slate node at a given path.

```ts
const firstNodeEl = await getDOMNodeByPath(page, elementHandle, [0]);
await firstNodeEl.hover();
```

### Click a node

```ts
await clickAtPath(page, elementHandle, [0]);
```

### Get the selection

```ts
const selection = await getSelection(page, editorHandle);

expect(selection).toBe({
  anchor: { path: [0, 0], offset: 0 },
  focus: { path: [0, 0], offset: 7 },
});
```

### Select a point or range

In order to type at a specific point in the editor, you'll need to select that point using `setSelection`.

If you select a single point (consisting of a `path` and an `offset`), the cursor will be placed at that point. If you select a range (consisting of an `anchor` and a `focus`), that range will be selected. If you select a path, the entire node at that path will be selected.

Make sure you focus the editor before setting the selection. Focusing the editor using `editable.focus()` may not work correctly in WebKit, so the best way of doing this is with `clickAtPath`.

```ts
// Click the first paragraph to focus the editor 
await clickAtPath(page, editorHandle, [0]);

await setSelection(page, editorHandle, {
  path: [0, 0],
  offset: 2,
});

await page.keyboard.type('Hello world!');
```

## Working with Editor Methods

You can't directly import queries or transforms into Playwright tests since they run outside the browser context. Instead:

1. Interact with the editor like a user would (preferred)
2. Call methods on the editor object inside `evaluate`/`evaluateHandle`:

```ts
await editorHandle.evaluate((editor) => {
  editor.tf.insertNodes(/* ... */);
});
```

See [Playwright's docs](https://playwright.dev/docs/evaluating) for more about `evaluate` and `evaluateHandle`.

## API

### `getEditorHandle`

<API name="getEditorHandle">
Gets handle to Plate editor instance.

<APIParameters>
  <APIItem name="page" type="Page">
    Playwright page object.
  </APIItem>
  <APIItem name="editable" type="Locator" optional>
    Locator for editable element. Defaults to first [data-slate-editor].
  </APIItem>
</APIParameters>

<APIReturns type="EditorHandle">
  Handle to Plate editor instance.
</APIReturns>
</API>

### `getNodeByPath`

<API name="getNodeByPath">
Gets node at specified path.

<APIParameters>
  <APIItem name="page" type="Page">
    Playwright page object.
  </APIItem>
  <APIItem name="editorHandle" type="EditorHandle">
    Handle to editor instance.
  </APIItem>
  <APIItem name="path" type="Path">
    Path to node.
  </APIItem>
</APIParameters>

<APIReturns type="JSHandle<TNode>">
  Handle to node at path.
</APIReturns>
</API>

### `getDOMNodeByPath`

<API name="getDOMNodeByPath">
Gets DOM node for Slate node at path.

<APIParameters>
  <APIItem name="page" type="Page">
    Playwright page object.
  </APIItem>
  <APIItem name="editorHandle" type="EditorHandle">
    Handle to editor instance.
  </APIItem>
  <APIItem name="path" type="Path">
    Path to node.
  </APIItem>
</APIParameters>

<APIReturns type="ElementHandle">
  ElementHandle for corresponding DOM node.
</APIReturns>
</API>

### `clickAtPath`

<API name="clickAtPath">
Simulates click on node at path.

<APIParameters>
  <APIItem name="page" type="Page">
    Playwright page object.
  </APIItem>
  <APIItem name="editorHandle" type="EditorHandle">
    Handle to editor instance.
  </APIItem>
  <APIItem name="path" type="Path">
    Path to node to click.
  </APIItem>
</APIParameters>
</API>

### `getSelection`

<API name="getSelection">
Gets current editor selection.

<APIParameters>
  <APIItem name="page" type="Page">
    Playwright page object.
  </APIItem>
  <APIItem name="editorHandle" type="EditorHandle">
    Handle to editor instance.
  </APIItem>
</APIParameters>

<APIReturns type="Selection">
  Current editor selection.
</APIReturns>
</API>

### `setSelection`

<API name="setSelection">
Sets editor selection to specified range.

<APIParameters>
  <APIItem name="page" type="Page">
    Playwright page object.
  </APIItem>
  <APIItem name="editorHandle" type="EditorHandle">
    Handle to editor instance.
  </APIItem>
  <APIItem name="at" type="Location">
    Location to set selection.
  </APIItem>
</APIParameters>
</API>

### `getTypeAtPath`

<API name="getTypeAtPath">
Gets type of node at path.

<APIParameters>
  <APIItem name="page" type="Page">
    Playwright page object.
  </APIItem>
  <APIItem name="editorHandle" type="EditorHandle">
    Handle to editor instance.
  </APIItem>
  <APIItem name="path" type="Path">
    Path to node.
  </APIItem>
</APIParameters>

<APIReturns type="string">
  Type of node at path.
</APIReturns>
</API>
