---
title: Comments
docs:
  - route: /docs/components/comment-leaf
    title: Comment Leaf
  - route: /docs/components/comment-toolbar-button
    title: Comment Toolbar Button
  - route: /docs/components/comments-popover
    title: Comments Popover
---

<ComponentPreview name="comments-demo" />

<PackageInfo>

## Features

- Add text comments as marks.
- Comments can include explanations, suggestions, questions, notes, or ideas for content improvement.
- Add a comment by selecting the text and using the comment button or hotkey **`Cmd+Shift+M`**.

</PackageInfo>

## Installation

```bash
npm install @udecode/plate-comments
```

## Usage

```tsx
import { CommentsPlugin } from '@udecode/plate-comments/react';

const editor = createPlateEditor({
  plugins: [
    // ...otherPlugins,
    CommentsPlugin,
  ],
});
```

## Keyboard Shortcuts

<KeyTable>
  <KeyTableItem hotkey="Cmd + Shift + M">
    Add a comment on the selected text.
  </KeyTableItem>
</KeyTable>

## Plugins

### `CommentsPlugin`

<API name="CommentsPlugin">
<APIOptions>
  <APIItem name="newText" type="string">
    The text for a new comment.
  </APIItem>
  <APIItem name="myUser" type="CommentUser">
    The current user's information.
  </APIItem>
  <APIItem name="userById" type="(id: string) => CommentUser">
    Function to get a user by their ID.
  </APIItem>
  <APIItem name="commentById" type="(id: string) => TComment">
    Function to get a comment by its ID.
  </APIItem>
  <APIItem name="activeComment" type="TComment">
    The currently active comment.
  </APIItem>
</APIOptions>
</API>

## Transforms

### `editor.tf.insert.comment`

Insert a new comment mark.

### `editor.api.comment.updateComment`

Updates an existing comment.

### `editor.api.comment.addRawComment`

Adds a new raw comment.

### `editor.api.comment.addComment`

Adds a new comment.

### `editor.api.comment.removeComment`

Removes a comment.

### `editor.api.comment.resetNewCommentValue`

Resets the value of a new comment.

## Store State

### `CommentStoreState`

<API name="CommentStoreState">
<APIState>
  <APIItem name="id" type="string">
    The unique ID of the comment.
  </APIItem>
  <APIItem name="isMenuOpen" type="boolean">
    Whether the menu associated with this comment is open.
  </APIItem>
  <APIItem name="editingValue" type="Value | null">
    The value currently being edited, or null if no editing in progress.
  </APIItem>
</APIState>
</API>

## Utils

### `findCommentNode`

Finds the comment node in the editor.

<API name="findCommentNode">
<APIOptions type="EditorNodesOptions" optional>
    Additional options for finding the node.
</APIOptions>
</API>

### `findCommentNodeById`

Finds the comment node in the editor by its ID.

<API name="findCommentNodeById">
<APIParameters>
  <APIItem name="id" type="string">
    The ID of the comment node to find.
  </APIItem>
</APIParameters>
</API>

### `getCommentCount`

Gets the count of comments in a comment node.

<API name="getCommentCount">
<APIParameters>
  <APIItem name="node" type="TCommentText">
    The comment node.
  </APIItem>
</APIParameters>
</API>

### `getCommentKey`

Generates a comment key based on the provided ID.

<API name="getCommentKey">
<APIParameters>
  <APIItem name="id" type="string">
    The ID of the comment.
  </APIItem>
</APIParameters>
</API>

### `getCommentKeyId`

Extracts the comment ID from a comment key.

<API name="getCommentKeyId">
<APIParameters>
  <APIItem name="key" type="string">
    The comment key.
  </APIItem>
</APIParameters>
</API>

### `getCommentKeys`

Returns an array of comment keys present in the given node.

<API name="getCommentKeys">
<APIParameters>
  <APIItem name="node" type="TCommentText">
    The node to check for comment keys.
  </APIItem>
</APIParameters>
</API>

### `getCommentNodeEntries`

Returns an array of node entries for comment nodes in the editor.

### `getCommentNodesById`

Returns an array of node entries for comment nodes with a specific ID in the editor.

<API name="getCommentNodesById">
<APIParameters>
  <APIItem name="id" type="string">
    The ID of the comment nodes to retrieve.
  </APIItem>
</APIParameters>
</API>

### `getCommentPosition`

Calculates the position of a comment node relative to the editor.

<API name="getCommentPosition">
<APIParameters>
  <APIItem name="node" type="TCommentText">
    The comment node for which to calculate the position.
  </APIItem>
</APIParameters>
</API>

### `getCommentUrl`

Generates a URL with a query parameter for a specific comment ID.

<API name="getCommentUrl">
<APIParameters>
  <APIItem name="commentId" type="string">
    The ID of the comment.
  </APIItem>
</APIParameters>
</API>

### `getElementAbsolutePosition`

Calculates the absolute position of an HTML element relative to the document.

<API name="getElementAbsolutePosition">
<APIParameters>
  <APIItem name="element" type="HTMLElement">
    The HTML element for which to calculate the absolute position.
  </APIItem>
</APIParameters>
</API>

### `isCommentKey`

Checks if a given key is a comment key.

<API name="isCommentKey">
<APIParameters>
  <APIItem name="key" type="string">
    The key to check.
  </APIItem>
</APIParameters>

<APIReturns type="boolean">
  Whether the key is a comment key.
</APIReturns>
</API>

### `isCommentNodeById`

Checks if a given node is a comment with the specified ID.

<API name="isCommentNodeById">
<APIParameters>
  <APIItem name="node" type="TNode">
    The node to check.
  </APIItem>
  <APIItem name="id" type="string">
    The ID of the comment.
  </APIItem>
</APIParameters>

<APIReturns type="boolean">
  Whether the node is a comment with the specified ID.
</APIReturns>
</API>

### `isCommentText`

Checks if a given node is a comment text node.

<API name="isCommentText">
<APIParameters>
  <APIItem name="node" type="TNode">
    The node to check.
  </APIItem>
</APIParameters>

<APIReturns type="boolean">
  Whether the node is a comment text node.
</APIReturns>
</API>

### `removeCommentMark`

Removes the comment mark from the editor.

### `unsetCommentNodesById`

Unsets comment nodes with the specified ID from the editor.

<API name="unsetCommentNodesById">
<APIParameters>
  <APIItem name="id" type="string">
    The ID of the comment nodes to unset.
  </APIItem>
</APIParameters>
</API>

## Components

### `CommentUser`

An interface representing a user who can make comments.

<API name="CommentUser">
<APIParameters>
  <APIItem name="id" type="string">
    The unique ID of the user.
  </APIItem>
  <APIItem name="name" type="string">
    The name of the user.
  </APIItem>
  <APIItem name="avatarUrl" type="string" optional>
    The URL of the user's avatar.
  </APIItem>
</APIParameters>
</API>

### `TComment`

Interface for comment data.

<API name="TComment">
<APIAttributes>
  <APIItem name="id" type="string">
    A unique ID for the comment.
  </APIItem>
  <APIItem name="value" type="Value">
    The Slate value of the comment.
  </APIItem>
  <APIItem name="createdAt" type="number">
    Timestamp when the comment was created.
    - **Default:** `Date.now()`
  </APIItem>
  <APIItem name="userId" type="string">
    ID of the author of the comment.
  </APIItem>
  <APIItem name="parentId" type="string" optional>
    ID of the parent comment it replies to.
  </APIItem>
  <APIItem name="isResolved" type="boolean" optional>
    Whether the comment is resolved.
  </APIItem>
</APIAttributes>
</API>

### `TCommentText`

Interface for text nodes that can contain comments.

<API name="TCommentText">
<APIAttributes>
  <APIItem name="comment_<id>" type="boolean" optional>
    Indicates whether this is a comment. Multiple comments can be present in a single text node.
  </APIItem>
</APIAttributes>
</API>

### `<CommentProvider>`

A jotai provider for comment data.

<API name="CommentProvider">
<APIProps>
  <APIItem name="extends" type="CommentStoreState">
    Base state type.
  </APIItem>
  <APIItem name="scope" type="Scope" optional>
    The scope of the provider.
  </APIItem>
</APIProps>
</API>

### `<CommentDeleteButton>`

A button component for deleting a comment.

<API name="CommentDeleteButton">
<APIState>
  <APIItem name="activeCommentId" type="string">
    The ID of the active comment.
  </APIItem>
  <APIItem name="id" type="string">
    The ID of the comment.
  </APIItem>
  <APIItem name="onCommentDelete" type="function">
    Callback when comment is deleted.
  </APIItem>
  <APIItem name="removeComment" type="function">
    Function to remove the comment.
  </APIItem>
  <APIItem name="setActiveCommentId" type="function">
    Function to set the active comment ID.
  </APIItem>
</APIState>
</API>

### `<CommentEditButton>`

A button component for editing a comment.

<API name="CommentEditButton">
<APIState>
  <APIItem name="setIsMenuOpen" type="function">
    Function to set the menu open state.
  </APIItem>
  <APIItem name="comment" type="TComment">
    The comment object.
  </APIItem>
  <APIItem name="editingValue" type="function">
    Function to set the editing value.
  </APIItem>
</APIState>
</API>

### `<CommentEditCancelButton>`

Button component for canceling comment edits.

### `<CommentEditSaveButton>`

<API name="CommentEditSaveButton">
<APIState>
  <APIItem name="editingValue" type="Value">
    The current editing value.
  </APIItem>
  <APIItem name="setEditingValue" type="function">
    Function to set the editing value.
  </APIItem>
  <APIItem name="id" type="string">
    The ID of the comment.
  </APIItem>
  <APIItem name="onCommentUpdate" type="function">
    Callback when comment is updated.
  </APIItem>
  <APIItem name="updateComment" type="function">
    Function to update the comment.
  </APIItem>
  <APIItem name="value" type="string">
    The comment value.
  </APIItem>
</APIState>
</API>

### `<CommentEditTextarea>`

A textarea component for editing a comment.

<API name="CommentEditTextarea">
<APIState>
  <APIItem name="setEditingValue" type="function">
    Function to set the editing value.
  </APIItem>
  <APIItem name="textareaRef" type="React.Ref">
    Reference to the textarea element.
  </APIItem>
  <APIItem name="value" type="string">
    The textarea value.
  </APIItem>
</APIState>
</API>

### `<CommentNewSubmitButton>`

A button component for submitting a new comment.

<API name="CommentNewSubmitButton">
<APIState>
  <APIItem name="editingCommentText" type="string">
    The text being edited.
  </APIItem>
  <APIItem name="resetNewCommentValue" type="function">
    Function to reset the new comment value.
  </APIItem>
  <APIItem name="addComment" type="function">
    Function to add a comment.
  </APIItem>
  <APIItem name="isReplyComment" type="boolean">
    Whether this is a reply comment.
  </APIItem>
  <APIItem name="submitButtonText" type="string">
    Text for the submit button.
  </APIItem>
  <APIItem name="onCommentAdd" type="function">
    Callback when comment is added.
  </APIItem>
  <APIItem name="activeCommentId" type="string">
    The ID of the active comment.
  </APIItem>
  <APIItem name="comment" type="TComment">
    The comment object.
  </APIItem>
  <APIItem name="newValue" type="Value">
    The new comment value.
  </APIItem>
</APIState>
</API>

### `<CommentNewTextarea>`

A textarea component for adding a new comment.

<API name="CommentNewTextarea">
<APIState>
  <APIItem name="textareaRef" type="React.Ref">
    Reference to the textarea element.
  </APIItem>
  <APIItem name="placeholder" type="string">
    Placeholder text.
  </APIItem>
  <APIItem name="value" type="string">
    The textarea value.
  </APIItem>
  <APIItem name="setNewValue" type="function">
    Function to set the new value.
  </APIItem>
</APIState>
</API>

### `<CommentResolveButton>`

Button component for resolving/unresolving comments.

### `<CommentUserName>`

Component for displaying a comment user's name.

### `<CommentsPositioner>`

<API name="CommentsPositioner">
<APIState>
  <APIItem name="activeCommentId" type="string">
    The ID of the active comment.
  </APIItem>
  <APIItem name="position" type="object">
    Position coordinates (top and left).
  </APIItem>
</APIState>
</API>

## Hooks

### `useActiveCommentNode`

A custom hook that retrieves the active comment node based on the active comment ID.

<API name="useActiveCommentNode">
<APIReturns type="TCommentText | null">
  The active comment node, or null if none found.
</APIReturns>
</API>

### `useCommentAddButton`

A custom hook that provides functionality for adding a comment mark to the selected text and setting focus to the comment textarea.

<API name="useCommentAddButton">
<APIReturns type="{ props: { onClick: () => void } }">
  Props for the comment add button.
</APIReturns>
</API>

### `useCommentItemContentState`

A state hook for the comment item content component.

<API name="useCommentItemContentState">
<APIReturns type="object">
  <APIItem name="comment" type="TComment">
    The comment object.
  </APIItem>
  <APIItem name="isReplyComment" type="boolean">
    Whether this is a reply comment.
  </APIItem>
  <APIItem name="commentText" type="string">
    The comment text content.
  </APIItem>
  <APIItem name="user" type="CommentUser">
    The comment author.
  </APIItem>
  <APIItem name="myUserId" type="string">
    Current user's ID.
  </APIItem>
  <APIItem name="editingValue" type="Value">
    Current editing value.
  </APIItem>
  <APIItem name="isMyComment" type="boolean">
    Whether current user is the author.
  </APIItem>
</APIReturns>
</API>

### `useCommentLeaf`

A behavior hook for the comment leaf component.

<API name="useCommentLeaf">
<APIParameters>
  <APIItem name="setActiveCommentId" type="function">
    Function to set active comment ID.
  </APIItem>
  <APIItem name="lastCommentId" type="string">
    ID of the last comment in the leaf.
  </APIItem>
</APIParameters>

<APIReturns type="object">
  Props for the comment leaf.
    <APIItem name="onClick" type="function">
      Click event handler.
    </APIItem>
</APIReturns>
</API>

### `useCommentValue`

A custom hook that focuses and selects the text inside a textarea.

<API name="useCommentValue">
<APIReturns type="React.Ref">
  Reference to the textarea element.
</APIReturns>
</API>

### `useCommentsResolved`

A custom hook that returns an array of resolved comments.

<API name="useCommentsResolved">
<APIReturns type="TComment[]">
  Array of resolved comments.
</APIReturns>
</API>

### `useCommentsShowResolvedButton`

A custom hook that returns the props for a button component used to show resolved comments.

<API name="useCommentsShowResolvedButton">
<APIReturns type="object">
   <APIItem name="pressed" type="boolean">
   A boolean indicating whether the button is pressed.
   </APIItem>
   <APIItem name="onClick" type="function">
   A function to call when the button is clicked.
   </APIItem>
</APIReturns>
</API>